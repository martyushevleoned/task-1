some another changes by Petrov
some changes by Martyushev
